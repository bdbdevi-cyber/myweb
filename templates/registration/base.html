{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}My Shop{% endblock %}</title>

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="{% static 'shop/css/styles.css' %}">

    <style>
        body {
            margin: 0;
            padding-bottom: 70px; /* space for bottom nav */
            font-family: Arial, sans-serif;
        }

        /* ===== PROFILE POPUP ===== */
        .profile-popup-bg {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.55);
            z-index: 6000;
        }
        .profile-popup-box {
            width: 90%;
            max-width: 360px;
            background: #fff;
            padding: 25px;
            border-radius: 14px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 5px 18px rgba(0,0,0,0.25);
            text-align: center;
        }
        .popup-btn {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border-radius: 10px;
            border: none;
            font-size: 16px;
            cursor: pointer;
        }
        .existing-btn { background: #0d6efd; color: #fff; }
        .new-btn { background: #28a745; color: #fff; }
        .close-btn { background: #dc3545; color: #fff; }

        /* ===== TOP NAV ===== */
        .top-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: #fff;
            padding: 10px 0;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 2000;
        }
        .top-nav a {
            position: relative;
            text-decoration: none;
            color: #000;
            font-size: 16px;
            margin: 0 5px;
        }
        .top-nav .badge {
            position: absolute;
            top: -5px;
            right: -10px;
            background: red;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 12px;
        }

        /* ===== BANNER ===== */
        .banner img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* ===== BOTTOM NAV ===== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #fff;
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            box-shadow: 0 -2px 6px rgba(0,0,0,0.15);
            z-index: 3000;
        }
        .bottom-nav a, .bottom-nav span {
            text-decoration: none;
            color: #000;
            font-size: 16px;
            cursor: pointer;
        }

        /* ===== FILTER DROPUP ===== */
        .filters-dropup {
            display: none;
            position: absolute;
            bottom: 55px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            border-radius: 8px;
            border: 1px solid #ccc;
            min-width: 180px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 4000;
        }
        .filters-dropup a {
            display: block;
            padding: 10px;
            text-align: center;
            color: #000;
            text-decoration: none;
        }
        .filters-dropup a:hover {
            background: #f1f5ff;
        }
    </style>
</head>

<body>

<!-- ===== PROFILE POPUP ===== -->
<div class="profile-popup-bg" id="profilePopup">
    <div class="profile-popup-box">
        <h3>Select Option</h3>

        {% if user.is_authenticated %}
            <a href="{% url 'profile' %}"><button class="popup-btn existing-btn">My Profile</button></a>
            <a href="{% url 'logout' %}"><button class="popup-btn new-btn">Logout</button></a>
        {% else %}
            <a href="{% url 'login' %}"><button class="popup-btn existing-btn">Existing User</button></a>
            <a href="{% url 'signup' %}"><button class="popup-btn new-btn">New User</button></a>
        {% endif %}

        <button class="popup-btn close-btn" onclick="closeProfilePopup()">Close</button>
    </div>
</div>

<!-- ===== TOP NAV ===== -->
<nav class="top-nav">
    <a href="{% url 'home' %}">üè† Home</a>
    <a href="{% url 'category' 'sarees' %}">üß£ Sarees</a>
    <a href="{% url 'category' 'dress' %}">üëó Dresses</a>
    <span onclick="toggleFilters()">üîç Filters</span>

    {% if user.is_authenticated %}
        <a href="{% url 'wishlist' %}">
            ‚ù§Ô∏è Wishlist
            {% with wishlist_count=user.wishlist_set.count %}
            {% if wishlist_count > 0 %}
                <span class="badge">{{ wishlist_count }}</span>
            {% endif %}
            {% endwith %}
        </a>
    {% else %}
        <a href="{% url 'login' %}">‚ù§Ô∏è Wishlist</a>
    {% endif %}
</nav>

<!-- ===== BANNER (HOME ONLY) ===== -->
{% if request.resolver_match.url_name == 'home' %}
<div class="home-banner">
    <img src="{% static 'shop/images/sareeeeees.jpg' %}" alt="Banner">
</div>
{% endif %}

<!-- ===== MAIN CONTENT ===== -->
<main class="container">
    {% block content %}{% endblock %}
</main>

<!-- ===== BOTTOM NAV ===== -->
<nav class="bottom-nav">
    <a href="{% url 'home' %}">üè† Home</a>
    <a href="{% url 'category' 'sarees' %}">üß£ Sarees</a>
    <a href="{% url 'category' 'dress' %}">üëó Dresses</a>
    <span onclick="toggleFilters()">üîç Filters</span>

    <div class="filters-dropup" id="filtersDropup">
        <a href="{% url 'filters' %}?order=price_asc">Price Low ‚Üí High</a>
        <a href="{% url 'filters' %}?order=price_desc">Price High ‚Üí Low</a>
    </div>
</nav>

<script>
    function openProfilePopup() {
        document.getElementById('profilePopup').style.display = 'block';
    }
    function closeProfilePopup() {
        document.getElementById('profilePopup').style.display = 'none';
    }
    function toggleFilters() {
        const f = document.getElementById('filtersDropup');
        f.style.display = (f.style.display === 'block') ? 'none' : 'block';
    }
</script>

</body>
</html>
