{% extends 'shop/base.html' %}
{% load static %}

{% block title %}Home - My Shop{% endblock %}

{% block content %}

<!-- ===== HOME BANNER ===== -->
<div class="home-banner">
    <img src="{% static 'shop/images/banner.svg' %}" alt="Home Banner">
</div>

<div class="container">
    <h2>Products</h2>

    <section class="product-grid">
        {% for p in products %}
        <article class="product-card {% if not p.available %}out-of-stock{% endif %}">

            <!-- ‚ù§Ô∏è WISHLIST ICON -->
            <div class="wishlist-icon">
                {% if user.is_authenticated %}
                    {% if p.id in wishlist_items %}
                        <a href="{% url 'wishlist_remove' p.id %}">‚ù§Ô∏è</a>
                    {% else %}
                        <a href="{% url 'wishlist_add' p.id %}">ü§ç</a>
                    {% endif %}
                {% else %}
                    <a href="{% url 'login' %}">ü§ç</a>
                {% endif %}
            </div>

            <!-- PRODUCT IMAGE -->
            <a href="{% if p.available %}{% url 'product_detail' p.id %}{% else %}#{% endif %}">
                {% if p.image %}
                    <img src="{{ p.image.url }}" alt="{{ p.name }}">
                {% else %}
                    <img src="{% static 'shop/images/placeholder.svg' %}" alt="No image">
                {% endif %}
            </a>

            <div class="meta">
                <h3>{{ p.name }}</h3>
                <p class="price">‚Çπ {{ p.price }}</p>

                {% if p.available %}
                    <p class="availability in-stock">In Stock</p>
                {% else %}
                    <p class="availability out-of-stock">Out of Stock</p>
                {% endif %}

                <p class="description">
                    {{ p.description|truncatechars:60 }}
                </p>

                <form action="{% url 'cart_add' p.id %}" method="post">
                    {% csrf_token %}
                    <button {% if not p.available %}disabled{% endif %}>
                        Add to Cart
                    </button>
                </form>
            </div>

        </article>
        {% endfor %}
    </section>
</div>

<style>
.product-card{
    position: relative;
}

.wishlist-icon{
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 22px;
    z-index: 10;
}

.wishlist-icon a{
    text-decoration: none;
}
</style>

{% endblock %}
